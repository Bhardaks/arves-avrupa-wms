<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0" />
  <title>SSH Envanter YÃ¶netimi</title>
  <link rel="stylesheet" href="/assets/css/styles.css" />
  <link rel="stylesheet" href="/assets/css/zebra-terminal.css" />
  <style>
    /* Dropdown Navigation Styles */
    .main-nav {
      display: flex;
      align-items: center;
      gap: 0;
      background: var(--header-bg, #1e293b);
    }
    
    .nav-link.standalone {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      text-decoration: none;
      color: var(--header-fg, #e2e8f0);
      transition: all 0.2s ease;
      border-right: 1px solid rgba(255,255,255,0.1);
    }
    
    .nav-link.standalone:hover {
      background: rgba(255,255,255,0.1);
      color: var(--accent, #3b82f6);
    }
    
    .nav-dropdown {
      position: relative;
      display: inline-block;
    }
    
    .nav-dropdown-trigger {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      cursor: pointer;
      color: var(--header-fg, #e2e8f0);
      transition: all 0.2s ease;
      border-right: 1px solid rgba(255,255,255,0.1);
      user-select: none;
    }
    
    .nav-dropdown-trigger:hover {
      background: rgba(255,255,255,0.1);
      color: var(--accent, #3b82f6);
    }
    
    .nav-dropdown:hover .nav-dropdown-trigger {
      background: rgba(255,255,255,0.1);
      color: var(--accent, #3b82f6);
    }
    
    .dropdown-arrow {
      margin-left: 8px;
      font-size: 10px;
      transition: transform 0.2s ease;
    }
    
    .nav-dropdown:hover .dropdown-arrow {
      transform: rotate(180deg);
    }
    
    .nav-dropdown-content {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      min-width: 220px;
      background: var(--card, #ffffff);
      border: 1px solid var(--border, #e5e7eb);
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      z-index: 1000;
      overflow: hidden;
    }
    
    .nav-dropdown:hover .nav-dropdown-content {
      display: block;
      animation: dropdownFadeIn 0.2s ease;
    }
    
    @keyframes dropdownFadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .nav-dropdown-link {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      text-decoration: none;
      color: var(--fg, #374151);
      transition: all 0.2s ease;
      border-bottom: 1px solid var(--border, #f3f4f6);
    }
    
    .nav-dropdown-link:last-child {
      border-bottom: none;
    }
    
    .nav-dropdown-link:hover {
      background: var(--hover, #f8fafc);
      color: var(--accent, #3b82f6);
    }
    
    .nav-icon {
      margin-right: 10px;
      font-size: 16px;
    }
    
    .nav-text {
      font-weight: 500;
      font-size: 14px;
    }
    
    /* Mobile responsive */
    @media (max-width: 768px) {
      .main-nav {
        display: none;
      }
    }
  <style>
    .inventory-overview {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .overview-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      text-align: center;
    }
    
    .overview-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--accent);
      margin-bottom: 0.5rem;
    }
    
    .overview-label {
      color: var(--muted);
      font-size: 0.9rem;
    }
    
    .search-filters {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .filter-row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr auto;
      gap: 1rem;
      align-items: end;
    }
    
    .inventory-table {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
    }
    
    .table-header {
      background: var(--bg);
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .inventory-grid {
      display: grid;
      grid-template-columns: auto 1fr auto auto auto auto 1fr auto;
      gap: 0;
    }
    
    .grid-header {
      background: var(--accent);
      color: white;
      padding: 1rem;
      font-weight: 600;
      font-size: 0.9rem;
      border-right: 1px solid rgba(255,255,255,0.2);
    }
    
    .grid-header:last-child {
      border-right: none;
    }
    
    .grid-cell {
      padding: 1rem;
      border-right: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      font-size: 0.9rem;
    }
    
    .grid-cell:last-child {
      border-right: none;
    }
    
    .grid-row:nth-child(even) {
      background: rgba(0,0,0,0.02);
    }
    
    .part-name {
      font-weight: 600;
      color: var(--fg);
    }
    
    .product-info {
      color: var(--muted);
      font-size: 0.8rem;
    }
    
    .quantity-badge {
      background: var(--accent);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-weight: 600;
      font-size: 0.8rem;
    }
    
    .location-tag {
      background: var(--muted);
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.8rem;
      font-family: monospace;
    }
    
    .action-buttons {
      display: flex;
      gap: 0.5rem;
    }
    
    .btn-small {
      padding: 0.5rem 1rem;
      font-size: 0.8rem;
      border-radius: 4px;
    }
    
    .empty-state {
      text-align: center;
      padding: 3rem;
      color: var(--muted);
    }
    
    .empty-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }
    
    @media (max-width: 768px) {
      .filter-row {
        grid-template-columns: 1fr;
        gap: 0.75rem;
      }
      
      .inventory-grid {
        grid-template-columns: 1fr;
      }
      
      .grid-header, .grid-cell {
        padding: 0.75rem;
      }
    }
  </style>
</head>
<body>
<header>
  <div class="header-brand">
    <h1>WMS Netsis Entegre</h1>
    <span class="header-subtitle">SSH Envanter YÃ¶netimi</span>
  </div>
  <div class="header-user">
    <div class="user-info" id="userInfo" style="display: none;">
      <span class="user-name" id="userName"></span>
      <span class="user-role" id="userRole"></span>
      <button class="logout-btn" id="logoutBtn">Ã‡Ä±kÄ±ÅŸ</button>
    </div>
  </div>
  <nav class="main-nav">
    <!-- Ana Sayfa linki -->
    <a href="/index.html" class="nav-link standalone">
      <span class="nav-icon">ğŸ </span>
      <span class="nav-text">Ana Sayfa</span>
    </a>
    
    <!-- Ana ModÃ¼ller Dropdown -->
    <div class="nav-dropdown">
      <div class="nav-dropdown-trigger">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-text">Ana ModÃ¼ller</span>
        <span class="dropdown-arrow">â–¼</span>
      </div>
      <div class="nav-dropdown-content">
        <a href="/products.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ“¦</span>
          <span class="nav-text">ÃœrÃ¼nler</span>
        </a>
        <a href="/orders.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ“‹</span>
          <span class="nav-text">SipariÅŸler</span>
        </a>
        <a href="/delivery-confirmation.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸšš</span>
          <span class="nav-text">Teslimat Ä°ÅŸlemleri</span>
        </a>
      </div>
    </div>
    
    <!-- Raf YÃ¶netimi Dropdown -->
    <div class="nav-dropdown">
      <div class="nav-dropdown-trigger">
        <span class="nav-icon">ğŸ¬</span>
        <span class="nav-text">Raf YÃ¶netimi</span>
        <span class="dropdown-arrow">â–¼</span>
      </div>
      <div class="nav-dropdown-content">
        <a href="/shelf-scanner.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ”</span>
          <span class="nav-text">Rafa Dizim</span>
        </a>
        <a href="/shelf-locations.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ“</span>
          <span class="nav-text">Lokasyonlar</span>
        </a>
        <a href="/shelf-admin.html" class="nav-dropdown-link">
          <span class="nav-icon">âš™ï¸</span>
          <span class="nav-text">Raf YÃ¶netimi</span>
        </a>
        <a href="/shelf-transfer.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ”„</span>
          <span class="nav-text">Raflar ArasÄ± Transfer</span>
        </a>
        <a href="/inventory-count.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ“Š</span>
          <span class="nav-text">Depo SayÄ±m</span>
        </a>
        <a href="/stock-management.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ“ˆ</span>
          <span class="nav-text">Stok YÃ¶netimi</span>
        </a>
      </div>
    </div>
    
    <!-- SSH Servis Dropdown -->
    <div class="nav-dropdown">
      <div class="nav-dropdown-trigger">
        <span class="nav-icon">ğŸ”§</span>
        <span class="nav-text">SSH Servis</span>
        <span class="dropdown-arrow">â–¼</span>
      </div>
      <div class="nav-dropdown-content">
        <a href="/service-request.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ”§</span>
          <span class="nav-text">Servis Talep</span>
        </a>
        <a href="/service-dashboard.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ“Š</span>
          <span class="nav-text">Servis Dashboard</span>
        </a>
        <a href="/ssh-inventory.html" class="nav-dropdown-link">
          <span class="nav-icon">ğŸ“‹</span>
          <span class="nav-text">SSH Envanter</span>
        </a>
      </div>
    </div>
  </nav>
  <div id="mobileNav" class="mobile-nav">
    <button id="mobileNavToggle" class="mobile-nav-toggle">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    <div id="mobileNavMenu" class="mobile-nav-menu">
      <div class="mobile-nav-header">
        <h3>WMS Sistemi</h3>
      </div>
      <div class="mobile-nav-group">
        <span class="mobile-nav-group-label">Ana ModÃ¼ller</span>
        <a href="/index.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ </span>
          <span class="nav-text">Ana Sayfa</span>
        </a>
        <a href="/products.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ“¦</span>
          <span class="nav-text">ÃœrÃ¼nler</span>
        </a>
        <a href="/orders.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ“‹</span>
          <span class="nav-text">SipariÅŸler</span>
        </a>
        <a href="/delivery-confirmation.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸšš</span>
          <span class="nav-text">Teslimat Ä°ÅŸlemleri</span>
        </a>
      </div>
      <div class="mobile-nav-group">
        <span class="mobile-nav-group-label">Raf YÃ¶netimi</span>
        <a href="/shelf-scanner.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ”</span>
          <span class="nav-text">Rafa Dizim</span>
        </a>
        <a href="/shelf-locations.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ“</span>
          <span class="nav-text">Lokasyonlar</span>
        </a>
        <a href="/shelf-admin.html" class="mobile-nav-link">
          <span class="nav-icon">âš™ï¸</span>
          <span class="nav-text">Raf YÃ¶netimi</span>
        </a>
        <a href="/shelf-transfer.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ”„</span>
          <span class="nav-text">Raflar ArasÄ± Transfer</span>
        </a>
        <a href="/inventory-count.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ“Š</span>
          <span class="nav-text">Depo SayÄ±m</span>
        </a>
      </div>
      <div class="mobile-nav-group">
        <span class="mobile-nav-group-label">SSH Servis</span>
        <a href="/service-request.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ”§</span>
          <span class="nav-text">Servis Talep</span>
        </a>
        <a href="/service-dashboard.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ“Š</span>
          <span class="nav-text">Servis Dashboard</span>
        </a>
        <a href="/ssh-inventory.html" class="mobile-nav-link">
          <span class="nav-icon">ğŸ“‹</span>
          <span class="nav-text">SSH Envanter</span>
        </a>
      </div>
    </div>
  </div>
</header>

<main class="main-content">
  <div class="content-header">
    <h2>ğŸ“‹ SSH Envanter YÃ¶netimi</h2>
    <p>SSH-01-01 alanÄ±ndaki parÃ§a envanteri ve stok durumu</p>
  </div>

  <!-- Inventory Overview -->
  <div class="inventory-overview">
    <div class="overview-card">
      <div class="overview-number" id="totalParts">-</div>
      <div class="overview-label">Toplam ParÃ§a Ã‡eÅŸidi</div>
    </div>
    <div class="overview-card">
      <div class="overview-number" id="totalQuantity">-</div>
      <div class="overview-label">Toplam Adet</div>
    </div>
    <div class="overview-card">
      <div class="overview-number" id="availableParts">-</div>
      <div class="overview-label">KullanÄ±labilir ParÃ§a</div>
    </div>
    <div class="overview-card">
      <div class="overview-number" id="recentTransfers">-</div>
      <div class="overview-label">Son 7 GÃ¼n Transfer</div>
    </div>
  </div>

  <!-- Search and Filters -->
  <div class="search-filters">
    <h3>ğŸ” Arama ve Filtreler</h3>
    <div class="filter-row">
      <div class="form-group">
        <label for="searchInput">SKU Arama</label>
        <input type="text" id="searchInput" placeholder="ÃœrÃ¼n SKU ara..." onkeyup="filterInventory()">
      </div>
      <div class="form-group">
        <label for="productFilter">ÃœrÃ¼n</label>
        <select id="productFilter" onchange="filterInventory()">
          <option value="">TÃ¼mÃ¼</option>
        </select>
      </div>
      <div class="form-group">
        <label for="statusFilter">Durum</label>
        <select id="statusFilter" onchange="filterInventory()">
          <option value="">TÃ¼mÃ¼</option>
          <option value="available">KullanÄ±labilir</option>
          <option value="used">KullanÄ±lmÄ±ÅŸ</option>
        </select>
      </div>
      <div class="form-group">
        <button class="btn btn-secondary" onclick="resetFilters()">Temizle</button>
      </div>
    </div>
  </div>

  <!-- Inventory Table -->
  <div class="inventory-table">
    <div class="table-header">
      <h3>SSH Envanter Listesi</h3>
      <button class="btn btn-primary" onclick="exportInventory()">ğŸ“„ Rapor Ä°ndir</button>
    </div>
    
    <div class="inventory-grid" id="inventoryGrid">
      <div class="grid-header">ID</div>
      <div class="grid-header">ParÃ§a AdÄ±</div>
      <div class="grid-header">ÃœrÃ¼n</div>
      <div class="grid-header">Adet</div>
      <div class="grid-header">Konum</div>
      <div class="grid-header">Kaynak</div>
      <div class="grid-header">Notlar</div>
      <div class="grid-header">Ä°ÅŸlemler</div>
      
      <!-- Dynamic content will be inserted here -->
    </div>
    
    <div id="emptyState" class="empty-state" style="display: none;">
      <div class="empty-icon">ğŸ“¦</div>
      <h3>SSH Envanteri BoÅŸ</h3>
      <p>HenÃ¼z SSH alanÄ±na transfer edilmiÅŸ parÃ§a bulunmuyor.</p>
    </div>
  </div>
</main>

<script>
let allInventory = [];
let filteredInventory = [];
let products = [];

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ“‹ SSH Envanter YÃ¶netimi yÃ¼klendi');
    loadProducts();
    loadInventory();
    loadOverviewStats();
});

// Load products for filter dropdown
async function loadProducts() {
    try {
        const response = await fetch('/api/products');
        products = await response.json();
        
        const productSelect = document.getElementById('productFilter');
        productSelect.innerHTML = '<option value="">TÃ¼mÃ¼</option>' + 
            products.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
    } catch (error) {
        console.error('âŒ Products loading error:', error);
    }
}

// Load SSH inventory
async function loadInventory() {
    try {
        const response = await fetch('/api/ssh-inventory');
        const data = await response.json();
        
        if (data.success) {
            allInventory = data.inventory;
            filteredInventory = [...allInventory];
            displayInventory();
        } else {
            console.error('âŒ Inventory loading failed:', data.error);
        }
    } catch (error) {
        console.error('âŒ Inventory loading error:', error);
        displayEmptyState();
    }
}

// Load overview statistics
async function loadOverviewStats() {
    try {
        const response = await fetch('/api/ssh-inventory/stats');
        const data = await response.json();
        
        if (data.success) {
            document.getElementById('totalParts').textContent = data.stats.total_parts || 0;
            document.getElementById('totalQuantity').textContent = data.stats.total_quantity || 0;
            document.getElementById('availableParts').textContent = data.stats.available_parts || 0;
            document.getElementById('recentTransfers').textContent = data.stats.recent_transfers || 0;
        }
    } catch (error) {
        console.error('âŒ Stats loading error:', error);
    }
}

// Display inventory grid
function displayInventory() {
    const grid = document.getElementById('inventoryGrid');
    const emptyState = document.getElementById('emptyState');
    
    if (filteredInventory.length === 0) {
        displayEmptyState();
        return;
    }
    
    emptyState.style.display = 'none';
    
    // Clear grid and rebuild with headers only
    const headers = `
        <div class="grid-header">ID</div>
        <div class="grid-header">ParÃ§a AdÄ±</div>
        <div class="grid-header">ÃœrÃ¼n</div>
        <div class="grid-header">Adet</div>
        <div class="grid-header">Konum</div>
        <div class="grid-header">Kaynak</div>
        <div class="grid-header">Notlar</div>
        <div class="grid-header">Ä°ÅŸlemler</div>
    `;
    
    const dataRows = filteredInventory.map(item => `
        <div class="grid-cell">#${item.id}</div>
        <div class="grid-cell">
            <div class="part-name">${item.part_name}</div>
            <div class="product-info">${item.product_name}</div>
        </div>
        <div class="grid-cell">
            <div>${item.product_name}</div>
            <div class="product-info">SKU: ${item.product_sku || '-'}</div>
        </div>
        <div class="grid-cell">
            <span class="quantity-badge">${item.quantity}</span>
        </div>
        <div class="grid-cell">
            <span class="location-tag">${item.location_code}</span>
        </div>
        <div class="grid-cell">
            <div style="font-size: 0.8rem;">
                <div>Paket: ${item.package_number || item.source_package_barcode}</div>
                <div style="color: var(--muted);">${formatDate(item.created_date)}</div>
            </div>
        </div>
        <div class="grid-cell">
            <textarea id="notes-${item.id}" placeholder="Paket iÃ§eriÄŸi notlarÄ±..." style="width: 100%; min-height: 40px; font-size: 0.8rem; border: 1px solid var(--border); border-radius: 4px; padding: 4px;" onchange="updateNotes(${item.id})">${item.notes || ''}</textarea>
        </div>
        <div class="grid-cell">
            <div class="action-buttons">
                <button class="btn btn-small btn-secondary" onclick="viewPartHistory(${item.id})">
                    ğŸ“‹ GeÃ§miÅŸ
                </button>
                <button class="btn btn-small btn-danger" onclick="emptyPackage(${item.id})" ${!item.is_available ? 'disabled' : ''}>
                    ğŸ—‘ï¸ Paket BoÅŸaldÄ±
                </button>
            </div>
        </div>
    `).join('');
    
    grid.innerHTML = headers + dataRows;
}

// Display empty state
function displayEmptyState() {
    const grid = document.getElementById('inventoryGrid');
    const emptyState = document.getElementById('emptyState');
    
    // Only show headers
    grid.innerHTML = `
        <div class="grid-header">ID</div>
        <div class="grid-header">ParÃ§a AdÄ±</div>
        <div class="grid-header">ÃœrÃ¼n</div>
        <div class="grid-header">Adet</div>
        <div class="grid-header">Konum</div>
        <div class="grid-header">Kaynak</div>
        <div class="grid-header">Notlar</div>
        <div class="grid-header">Ä°ÅŸlemler</div>
    `;
    
    emptyState.style.display = 'block';
}

// Filter inventory
function filterInventory() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const productId = document.getElementById('productFilter').value;
    const status = document.getElementById('statusFilter').value;
    
    filteredInventory = allInventory.filter(item => {
        const matchesSearch = !searchTerm || 
            (item.product_sku && item.product_sku.toLowerCase().includes(searchTerm));
            
        const matchesProduct = !productId || item.product_id.toString() === productId;
        
        const matchesStatus = !status || 
            (status === 'available' && item.is_available) ||
            (status === 'used' && !item.is_available);
            
        return matchesSearch && matchesProduct && matchesStatus;
    });
    
    displayInventory();
}

// Reset filters
function resetFilters() {
    document.getElementById('searchInput').value = '';
    document.getElementById('productFilter').value = '';
    document.getElementById('statusFilter').value = '';
    filteredInventory = [...allInventory];
    displayInventory();
}

// View part history
function viewPartHistory(inventoryId) {
    const item = allInventory.find(i => i.id === inventoryId);
    if (!item) return;
    
    alert(`ğŸ“‹ ParÃ§a GeÃ§miÅŸi\n\nParÃ§a: ${item.part_name}\nÃœrÃ¼n: ${item.product_name}\nKaynak Paket: ${item.source_package_barcode}\nOluÅŸturma: ${formatDate(item.created_date)}\nSon KullanÄ±m: ${item.last_used_date ? formatDate(item.last_used_date) : 'HenÃ¼z kullanÄ±lmamÄ±ÅŸ'}\nDurum: ${item.is_available ? 'KullanÄ±labilir' : 'KullanÄ±lmÄ±ÅŸ'}`);
}

// Transfer part to service
async function emptyPackage(inventoryId) {
    const item = allInventory.find(i => i.id === inventoryId);
    if (!item || !item.is_available) return;
    
    const confirmed = confirm(`ğŸ—‘ï¸ Paket BoÅŸaltma\n\nParÃ§a: ${item.part_name}\nAdet: ${item.quantity}\n\nBu paketi SSH envanterinden kaldÄ±rmak istediÄŸinize emin misiniz?\n(Bu iÅŸlem geri alÄ±namaz)`);
    
    if (confirmed) {
        try {
            const response = await fetch(`/api/ssh-inventory/${inventoryId}/empty`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            });
            
            const data = await response.json();
            
            if (data.success) {
                alert('âœ… Paket SSH envanterinden kaldÄ±rÄ±ldÄ±!');
                loadInventory();
                loadOverviewStats();
            } else {
                alert('âŒ Paket kaldÄ±rma hatasÄ±: ' + data.error);
            }
        } catch (error) {
            console.error('âŒ Empty package error:', error);
            alert('Paket kaldÄ±rma sÄ±rasÄ±nda hata oluÅŸtu: ' + error.message);
        }
    }
}

// Update notes for SSH inventory item
async function updateNotes(inventoryId) {
    const notesTextarea = document.getElementById(`notes-${inventoryId}`);
    const notes = notesTextarea.value.trim();
    
    try {
        const response = await fetch(`/api/ssh-inventory/${inventoryId}/notes`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ notes })
        });
        
        const data = await response.json();
        
        if (data.success) {
            // Visual feedback - briefly highlight the textarea
            notesTextarea.style.borderColor = 'var(--success)';
            setTimeout(() => {
                notesTextarea.style.borderColor = 'var(--border)';
            }, 1000);
            console.log('âœ… Notes updated for item:', inventoryId);
        } else {
            alert('âŒ Not gÃ¼ncelleme hatasÄ±: ' + data.error);
        }
    } catch (error) {
        console.error('âŒ Notes update error:', error);
        alert('Not gÃ¼ncelleme sÄ±rasÄ±nda hata oluÅŸtu: ' + error.message);
    }
}

// Export inventory report
function exportInventory() {
    const csvContent = [
        ['ID', 'ParÃ§a AdÄ±', 'ÃœrÃ¼n', 'Adet', 'Konum', 'Kaynak Paket', 'OluÅŸturma Tarihi', 'Durum'].join(','),
        ...filteredInventory.map(item => [
            item.id,
            `"${item.part_name}"`,
            `"${item.product_name}"`,
            item.quantity,
            item.location_code,
            item.source_package_barcode,
            formatDate(item.created_date),
            item.is_available ? 'KullanÄ±labilir' : 'KullanÄ±lmÄ±ÅŸ'
        ].join(','))
    ].join('\n');
    
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    const url = URL.createObjectURL(blob);
    link.setAttribute('href', url);
    link.setAttribute('download', `ssh-envanter-${new Date().toISOString().split('T')[0]}.csv`);
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// Utility functions
function formatDate(dateString) {
    if (!dateString) return '-';
    const date = new Date(dateString);
    return date.toLocaleString('tr-TR');
}

// Mobile navigation toggle
document.getElementById('mobileNavToggle').addEventListener('click', () => {
  const menu = document.getElementById('mobileNavMenu');
  menu.classList.toggle('show');
});

// Close mobile menu when clicking outside
document.addEventListener('click', (e) => {
  const nav = document.getElementById('mobileNav');
  const menu = document.getElementById('mobileNavMenu');
  if (!nav.contains(e.target)) {
    menu.classList.remove('show');
  }
});
</script>
</body>
</html>